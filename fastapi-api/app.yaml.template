service: default
runtime: python39
entrypoint: bash -c "alembic upgrade head && uvicorn main:app --host 0.0.0.0 --port $PORT"

env_variables:
  DB_USER: "__DB_USER__"
  DB_PASS: "__DB_PASS__"
  DB_NAME: "__DB_NAME__"
  CLOUD_SQL_CONNECTION_NAME: "__CLOUD_SQL_CONNECTION_NAME__"
  SECRET_KEY: "__BACKEND_SECRET_KEY__"
  DATABASE_URL: "__DB_URL__"

automatic_scaling:
  max_instances: 1